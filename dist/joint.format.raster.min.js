/*! Rappid v2.4.0 - HTML5 Diagramming Framework - TRIAL VERSION

Copyright (c) 2015 client IO

 2019-03-27 


This Source Code Form is subject to the terms of the Rappid Trial License
, v. 2.0. If a copy of the Rappid License was not distributed with this
file, You can obtain one at http://jointjs.com/license/rappid_v2.txt
 or from the Rappid archive as was distributed by client IO. See the LICENSE file.*/


!function(a){"use strict";function b(a,b){var c=document.createElement("canvas");c.width=a,c.height=b;var d=a-1,e=b-1,f=c.getContext("2d");try{f.fillStyle="rgb(1,1,1)",f.fillRect(d,e,1,1);var g=f.getImageData(d,e,1,1).data;if(1!==g[0]||1!==g[1]||1!==g[2])return!1}catch(h){return!1}return!0}function c(a,b){var c=f(b),d=g.rect({x:-c.left,y:-c.top,width:c.left+c.right,height:c.top+c.bottom});if(b.width&&b.height){var e=a.width+c.left+c.right,h=a.height+c.top+c.bottom;d.scale(e/b.width,h/b.height)}return g.Rect(a).moveAndExpand(d)}function d(a){var b=1;if(void 0!==a&&(b=parseFloat(a),!Number.isFinite(b)||0===b))throw new Error("dia.Paper: invalid raster size ("+a+")");return b}function e(a,b){return{width:Math.max(Math.round(a.width*b),1),height:Math.max(Math.round(a.height*b),1)}}function f(b){var c=a.util.normalizeSides(b.padding);return b.width&&b.height&&(c.left+c.right>=b.width&&(c.left=c.right=0),c.top+c.bottom>=b.height&&(c.top=c.bottom=0)),c}function h(a){return a.replace(/<image[^>]*>/g,function(a){var b=a.match(/href="([^"]*)"/),c=b&&b[1],d="data:image/svg+xml";if(c&&c.substr(0,d.length)===d){var e=atob(c.substr(c.indexOf(",")+1));return e.substr(e.indexOf("<svg"))}return a})}a.dia.Paper.prototype.toDataURL=function(f,g){if("function"!=typeof this.toSVG)throw new Error("The joint.format.svg.js plugin must be loaded.");g=g||{};var i=g.area||this.paperToLocalRect(this.getContentBBox()),j=c(i,g),k=a.util.isNumber(g.width)&&a.util.isNumber(g.height)?g:j,l=e(k,d(g.size));if(!b(l.width,l.height))throw new Error("dia.Paper: raster size exceeded.");var m,n=new Image;n.onload=function(){function b(){j=document.createElement("canvas"),j.width=l.width,j.height=l.height,i=j.getContext("2d"),i.fillStyle=g.backgroundColor||"white",i.fillRect(0,0,l.width,l.height)}function c(){e=j.toDataURL(g.type,g.quality),f(e),d()}function d(){j.svg&&a.util.isFunction(j.svg.stop)&&setTimeout(j.svg.stop,1)}var e,i,j;b();try{i.drawImage(n,0,0,l.width,l.height),c()}catch(k){if("undefined"==typeof canvg)return void console.error("Canvas tainted. Canvg library required.");b();var o={ignoreDimensions:!0,ignoreClear:!0,ignoreMouse:!0,ignoreAnimation:!0,offsetX:0,offsetY:0,useCORS:!0};canvg(j,m,a.util.assign(o,{forceRedraw:function(){return!this.called&&(this.called=!0,!0)}.bind({called:!1}),renderCallback:function(){try{c()}catch(e){d(),m=h(m),b(),canvg(j,m,a.util.assign(o,{renderCallback:c}))}}}))}},this.toSVG(function(a){m=a,n.src="data:image/svg+xml,"+encodeURIComponent(a)},{convertImagesToDataUris:!0,area:j,useComputedStyles:g.useComputedStyles,stylesheet:g.stylesheet,preserveDimensions:{width:l.width,height:l.height}})},a.dia.Paper.prototype.toPNG=function(a,b){b=b||{},b.type="image/png",this.toDataURL(a,b)},a.dia.Paper.prototype.toJPEG=function(a,b){b=b||{},b.type="image/jpeg",this.toDataURL(a,b)},a.dia.Paper.prototype.openAsPNG=function(b){var c="menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes",d=a.util.uniqueId("png_output");this.toPNG(function(a){var b=window.open("",d,c);b.document.write('<img src="'+a+'"/>')},a.util.assign({padding:10},b))}}(joint);